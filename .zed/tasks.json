[
    {
        "label": "Run CAN Bridge Daemon",
        "command": "RUST_LOG=info cargo run -- --tcp-bind 127.0.0.1:9500 --ws-bind 127.0.0.1:9501",
        "cwd": "$ZED_WORKTREE_ROOT",
        "shell": {
            "with_arguments": {
                "program": "/bin/bash",
                "args": ["-lc"]
            }
        },
        "reveal": "always",
        "use_new_terminal": true
    },
    {
        "label": "Test CAN bridge daemon over TCP",
        "command": "poetry run python test_can_bridge_tcp.py",
        "cwd": "$ZED_WORKTREE_ROOT/test",
        "shell": {
            "with_arguments": {
                "program": "/bin/bash",
                "args": ["-lc"]
            }
        },
        "reveal": "always"
    },
    {
        "label": "Test CAN bridge daemon over Binary TCP",
        "command": "poetry run python test_can_bridge_tcp_binary.py",
        "cwd": "$ZED_WORKTREE_ROOT/test",
        "shell": {
            "with_arguments": {
                "program": "/bin/bash",
                "args": ["-lc"]
            }
        },
        "reveal": "always"
    },
    {
        "label": "Test CAN bridge daemon over Websockets",
        "command": "poetry run python test_can_bridge_ws.py",
        "cwd": "$ZED_WORKTREE_ROOT/test",
        "shell": {
            "with_arguments": {
                "program": "/bin/bash",
                "args": ["-lc"]
            }
        },
        "reveal": "always"
    },
    {
        "label": "Test CAN bridge daemon over gRPC",
        "command": "poetry run python test_can_bridge_grpc.py",
        "cwd": "$ZED_WORKTREE_ROOT/test",
        "shell": {
            "with_arguments": {
                "program": "/bin/bash",
                "args": ["-lc"]
            }
        },
        "reveal": "always"
    },
    {
        "label": "Build release binary",
        "command": "cargo build --release",
        "cwd": "$ZED_WORKTREE_ROOT",
        "shell": {
            "with_arguments": {
                "program": "/bin/bash",
                "args": ["-lc"]
            }
        },
        "reveal": "always"
    },
    {
        "label": " App Test + Replay (spawns 2nd daemon)",
        "command": "cargo build --release && ./test/test_can_bridge.py --bridge-bin ./target/release/can_bridge_daemon",
        "cwd": "$ZED_WORKTREE_ROOT",
        "shell": {
            "with_arguments": {
                "program": "/bin/bash",
                "args": ["-lc"]
            }
        },
        "reveal": "always"
    }
]
